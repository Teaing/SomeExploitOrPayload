#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Author:Tea

import imaplib


class MyIMAP(object):

    def __init__(self, serverIP, serverPort=993, isSSL=True):
        self.serverIP = serverIP
        self.serverPort = serverPort if isSSL else 143  # SSL 可以换端口
        if isSSL:
            self.mailIMAP = imaplib.IMAP4_SSL(self.serverIP, self.serverPort)
        else:
            self.mailIMAP = imaplib.IMAP4(self.serverIP, self.serverPort)

    def auth(self, emailName, emailPass):
        try:
            self.mailIMAP.login(emailName, emailPass)
            print '{0}\t{1}\tSuccess!'.format(emailName, emailPass)
            self.mailIMAP.close()
        except Exception, e:
            print '{0}\t{1}\tFailure!'.format(emailName, emailPass)


def main():
    address = 'imap.qq.com'
    pop3test = MyIMAP(serverIP=address)
    pop3test.auth('admin', 'pass')


if __name__ == '__main__':
    main()
