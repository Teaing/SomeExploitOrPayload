#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Author:Tea

import poplib


class MyPOP3(object):

    def __init__(self, serverIP, serverPort=995, isSSL=True, deBug=0, timeOut=3):
        self.serverIP = serverIP
        self.serverPort = serverPort if isSSL else 110  # SSL 可以换端口
        if isSSL:
            self.mailPOP3 = poplib.POP3_SSL(self.serverIP, self.serverPort)  # python3 才有timeout
            print 'POP3 SSL timeout setting Failure...'
        else:
            self.mailPOP3 = poplib.POP3(self.serverIP, self.serverPort, timeout=timeOut)
        self.mailPOP3.set_debuglevel(deBug)

    def auth(self, emailName, emailPass):
        try:
            self.mailPOP3.user(emailName)
            self.mailPOP3.pass_(emailPass)
            print '{0}\t{1}\tSuccess!'.format(emailName, emailPass)
            self.mailPOP3.quit()
        except poplib.error_proto, e:
            print '{0}\t{1}\tFailure!'.format(emailName, emailPass)


def main():
    address = 'pop.qq.com'
    pop3test = MyPOP3(serverIP=address)
    pop3test.auth('admin', 'pass')


if __name__ == '__main__':
    main()
